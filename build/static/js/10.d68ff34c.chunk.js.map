{"version":3,"sources":["components/Uploader.js","components/Tips.js","pages/Home.js"],"names":["Dragger","Upload","Result","styled","div","H1","h1","Image","img","Input","input","Component","observer","ref1","useRef","ref2","useStores","ImageStore","UserStore","store","useLocalStore","width","setWidth","height","setHeight","serverFile","attributes","url","widthStr","heightStr","props","showUploadList","beforeUpload","file","console","log","setFil","setFilename","name","currentUser","message","warning","window","test","type","size","error","upload","then","catch","err","tip","spinning","isUploading","className","InboxOutlined","target","href","filename","src","alt","ref","onChange","current","value","placeholder","fullStr","Tips","children","Home","Uploader"],"mappings":"urBAMQA,EAAYC,IAAZD,QAEFE,EAASC,IAAOC,IAAV,KAKNC,EAAKF,IAAOG,GAAV,KAIFC,EAAQJ,IAAOK,IAAV,KAGLC,EAAQN,IAAOO,MAAV,KAgHIC,EAzGGC,aAAS,WACzB,IAAMC,EAAOC,mBACPC,EAAOD,mBAFgB,EAIEE,cAAxBC,EAJsB,EAItBA,WAAWC,EAJW,EAIXA,UACZC,EAAQC,aAAc,iBAAK,CAC/BC,MAAM,KACN,eACE,OAAOF,EAAME,MAAN,aAAkBF,EAAME,OAAQ,IAEzCC,SAL+B,SAKtBD,GACPF,EAAME,MAAQA,GAEhBE,OAAO,KACP,gBACE,OAAOJ,EAAMI,OAAN,aAAmBJ,EAAMI,QAAS,IAE3CC,UAZ+B,SAYrBD,GACRJ,EAAMI,OAASA,GAEjB,cACE,OAAON,EAAWQ,WAAWC,WAAWC,IAAID,WAAWC,IAAM,gBAAkBR,EAAMS,SAAWT,EAAMU,eAUpGC,EAAQ,CACZC,gBAAe,EACfC,aAAa,SAAAC,GAIX,OAHAC,QAAQC,IAAIF,GACZhB,EAAWmB,OAAOH,GAClBhB,EAAWoB,YAAYJ,EAAKK,MACE,OAA1BpB,EAAUqB,aACVC,IAAQC,QAAQ,uEACT,IAEXC,OAAOT,KAAOA,EACT,wCAAwCU,KAAKV,EAAKW,MAInDX,EAAKY,KAAO,SACdL,IAAQM,MAAM,+BACP,IAET7B,EAAW8B,SACRC,MAAK,SAACvB,GACLS,QAAQC,IAAI,4BACZD,QAAQC,IAAIV,MACXwB,OAAM,SAACC,GACRhB,QAAQC,IAAIe,GACdhB,QAAQC,IAAI,gCAEP,IAfLK,IAAQM,MAAM,oEACN,MAkBd,OACE,6BACE,kBAAC,IAAD,CAAMK,IAAI,qBAAMC,SAAUnC,EAAWoC,aACrC,kBAACrD,EAAY8B,EACX,uBAAGwB,UAAU,wBACX,kBAACC,EAAA,EAAD,OAEF,uBAAGD,UAAU,mBAAb,sEACA,uBAAGA,UAAU,mBAAb,kHAMArC,EAAWQ,WACX,kBAACvB,EAAD,KACE,kBAACG,EAAD,iCACA,4BACE,wDACA,4BAAI,uBAAGmD,OAAO,SAASC,KAAMxC,EAAWQ,WAAWC,WAAWC,IAAID,WAAWC,KAAMV,EAAWQ,WAAWC,WAAWC,IAAID,WAAWC,MACnI,kDACA,4BAAKV,EAAWyC,UAChB,wDACA,4BACE,kBAACnD,EAAD,CAAOoD,IAAK1C,EAAWQ,WAAWC,WAAWC,IAAID,WAAWC,IAAKiC,IAAI,MAEvE,wDACA,4BACE,kBAACnD,EAAD,CAAOoD,IAAKhD,EAAMiD,SAlEZ,WAChB3C,EAAMG,SAAST,EAAKkD,QAAQC,QAiEqBpB,KAAK,OAAOqB,YAAY,qDAC/D,kBAACxD,EAAD,CAAOoD,IAAK9C,EAAM+C,SAhEX,WACjB3C,EAAMK,UAAUT,EAAKgD,QAAQC,QA+DqBpB,KAAK,OAAOqB,YAAY,sDAElE,4BACE,uBAAGR,KAAMtC,EAAM+C,QAASV,OAAO,UAAUrC,EAAM+C,YAKnD,S,gJC1HV,IAAMC,EAAOhE,IAAOC,IAAV,KAYKO,EANGC,aAAS,YAAe,IAAbwD,EAAY,EAAZA,SAE3B,OACE,kBAACD,EAAD,KAAOC,MCPLC,EAAOzD,aAAS,WAAO,IACpBM,EAAaF,cAAbE,UAEP,OACI,oCAEIA,EAAUqB,YAAc,KAAM,kBAAC,EAAD,mDAEhC,kBAAC+B,EAAD,UAIOD","file":"static/js/10.d68ff34c.chunk.js","sourcesContent":["import React,{useRef} from \"react\";\nimport {useStores} from \"../stores\";\nimport {observer,useLocalStore} from 'mobx-react';\nimport { Upload ,message,Spin} from 'antd';\nimport { InboxOutlined } from '@ant-design/icons';\nimport styled from \"styled-components\";\nconst { Dragger } = Upload\n\nconst Result = styled.div`\nmargin-top:30px;\nborder:1px solid #333;\npadding:20px;\n`\nconst H1 = styled.h1`\nmargin:20px 0;\ntext-align:center;\n`\nconst Image = styled.img`\nmax-width:300px;\n`\nconst Input = styled.input`\noutline: none;\nborder-radius: 4px;\nmargin-right:10px;\nborder:1px solid #333;\n`\n\nconst Component = observer(()=>{\n  const ref1 = useRef()\n  const ref2 = useRef()\n\n  const {ImageStore,UserStore} = useStores()\n  const store = useLocalStore(()=>({\n    width:null,\n    get widthStr(){\n      return store.width?`/w/${store.width}`:'';\n    },\n    setWidth(width){\n      store.width = width;\n    },\n    height:null,\n    get heightStr(){\n      return store.height?`/h/${store.height}`:'';\n    },\n    setHeight(height){\n      store.height = height;\n    },\n    get fullStr(){\n      return ImageStore.serverFile.attributes.url.attributes.url + '?imageView2/0' + store.widthStr + store.heightStr\n    },\n  }))\n  const bindWidth = ()=>{\n    store.setWidth(ref1.current.value)\n  }\n  const bindHeight = ()=>{\n    store.setHeight(ref2.current.value)\n  }\n\n  const props = {\n    showUploadList:false,\n    beforeUpload:file =>{\n      console.log(file)\n      ImageStore.setFil(file)\n      ImageStore.setFilename(file.name)\n      if (UserStore.currentUser === null){\n          message.warning('请先登录，在上传图片！')\n          return false\n      }\n      window.file = file\n      if (!/(svg$)|(png$)|(jpg$)|(jpeg$)|(gif$)/ig.test(file.type)){\n        message.error('只能上传png/svg/jpg/gif格式图片')\n        return  false\n      }\n      if (file.size > 1024*1024){\n        message.error('图片最大1M')\n        return false\n      }\n      ImageStore.upload()\n        .then((serverFile)=>{\n          console.log('上传成功')\n          console.log(serverFile)\n        }).catch((err)=>{\n          console.log(err)\n        console.log('上传失败')\n      })\n      return false\n    }\n  }\n\n  return (\n    <div>\n      <Spin tip=\"上传中\" spinning={ImageStore.isUploading}>\n      <Dragger {...props}>\n        <p className=\"ant-upload-drag-icon\">\n          <InboxOutlined />\n        </p>\n        <p className=\"ant-upload-text\">点击或拖拽即可上传图片</p>\n        <p className=\"ant-upload-hint\">\n          仅支持 png/gif/jpg/svg/jpeg 格式的图片，图片最大为1M\n        </p>\n      </Dragger>\n      </Spin>\n      {\n        ImageStore.serverFile?\n        <Result>\n          <H1>上传结果</H1>\n          <dl>\n            <dt>线上链接</dt>\n            <dd><a target=\"_blank\" href={ImageStore.serverFile.attributes.url.attributes.url}>{ImageStore.serverFile.attributes.url.attributes.url}</a></dd>\n            <dt>文件名</dt>\n            <dd>{ImageStore.filename}</dd>\n            <dt>图片预览</dt>\n            <dd>\n              <Image src={ImageStore.serverFile.attributes.url.attributes.url} alt=\"\"/>\n            </dd>\n            <dt>更多尺寸</dt>\n            <dd>\n              <Input ref={ref1} onChange={bindWidth} type=\"text\" placeholder=\"最大宽度（可选）\"/>\n              <Input ref={ref2} onChange={bindHeight} type=\"text\" placeholder=\"最大高度（可选）\"/>\n            </dd>\n            <dd>\n              <a href={store.fullStr} target=\"_blank\">{store.fullStr}</a>\n            </dd>\n          </dl>\n        </Result>\n          :\n          null\n      }\n\n    </div>\n  )\n})\nexport default Component","import React from \"react\";\nimport {observer} from \"mobx-react\";\nimport styled from \"styled-components\";\n\nconst Tips = styled.div`\nbackground:#bbd196;\npadding:10px;\nmargin:30px 0 ;\nborder-radius:4px;\n`\nconst Component = observer(({children})=>{\n\n  return (\n    <Tips>{children}</Tips>\n  )\n})\nexport default Component","import React from 'react'\nimport {observer} from 'mobx-react'\nimport {useStores} from \"../stores\";\nimport Uploader from  '../components/Uploader'\nimport Tips from '../components/Tips'\n\nconst Home = observer(() => {\n  const {UserStore} = useStores()\n  const User = ()=><>Hello {UserStore.currentUser.attributes.username}</>\n  return (\n      <>\n        {\n          UserStore.currentUser ? null: <Tips>请先登录在上传</Tips>\n        }\n        <Uploader/>\n      </>\n  )\n})\nexport default Home"],"sourceRoot":""}